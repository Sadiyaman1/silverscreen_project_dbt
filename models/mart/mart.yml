version: 2

models:
  - name: mart_monthly_movie_performance
    description: Final fact table providing a comprehensive view of monthly movie performance, including movie details, rental costs, sales, revenue, and profit.
    columns:
      - name: unique_row_id
        description: A unique identifier for each row, generated from movie_id, location_id, and month.
        tests:
          - not_null
          - unique

      - name: movie_id
        description: Unique identifier for each movie.
        tests:
          - not_null

      - name: movie_title
        description: Title of the movie.
        tests:
          - not_null

      - name: genre
        description: Genre category of the movie.
        tests:
          - accepted_values:
              values: ["Animation", "Action", "Comedy", "Horror", "Unknown", "Thriller", "Fantasy", "Sci-Fi", "Drama"]

      - name: studio
        description: Studio that produced the movie.

      - name: month
        description: Month relating to the cost and revenue for the movie.
        tests:
          - not_null

      - name: location_id
        description: Identifier for the cinema location.
        tests:
          - not_null

      - name: total_rental_cost
        description: The total cost to rent the movie from the studio for the month.

      - name: total_tickets_sold
        description: The total number of tickets sold for the movie in that month and location.
        tests:
          - revenue_non_negative

      - name: total_revenue
        description: Total revenue received from ticket sales for the movie in that month and location.
        tests:
          - revenue_non_negative

      - name: profit
        description: The profit generated (total revenue minus total rental cost) for the movie in that month and location.
